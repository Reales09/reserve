{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\n// Middleware para manejar autenticaci√≥n y redirecciones\nexport function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl;\n  \n  // Obtener token de la cookie\n  const token = request.cookies.get('auth-token');\n  const userInfo = request.cookies.get('user-info');\n  \n  // Log para debugging\n  console.log('üîç [MIDDLEWARE] Ruta:', pathname, 'Token:', !!token, 'UserInfo:', !!userInfo);\n  \n  // Rutas p√∫blicas que no requieren autenticaci√≥n\n  const publicRoutes = ['/login', '/register', '/forgot-password', '/reset-password'];\n  const isPublicRoute = publicRoutes.includes(pathname);\n  \n  // Rutas de la API que no requieren autenticaci√≥n\n  const isApiRoute = pathname.startsWith('/api/');\n  \n  // Rutas de autenticaci√≥n que requieren redirecci√≥n si ya est√° autenticado\n  const authRoutes = ['/login', '/register'];\n  const isAuthRoute = authRoutes.includes(pathname);\n  \n  // Si es una ruta de autenticaci√≥n y ya est√° autenticado, redirigir al calendar\n  if (isAuthRoute && token && userInfo) {\n    console.log('‚úÖ [MIDDLEWARE] Usuario autenticado en ruta de auth, redirigiendo a /calendar');\n    return NextResponse.redirect(new URL('/calendar', request.url));\n  }\n  \n  // Si no es una ruta p√∫blica y no est√° autenticado, redirigir al login\n  if (!isPublicRoute && !isApiRoute && !token) {\n    console.log('‚ùå [MIDDLEWARE] Usuario no autenticado, redirigiendo a /login');\n    const loginUrl = new URL('/login', request.url);\n    loginUrl.searchParams.set('redirect', pathname);\n    return NextResponse.redirect(loginUrl);\n  }\n  \n  // Si es una ruta protegida y est√° autenticado, permitir acceso\n  if (token && userInfo) {\n    console.log('‚úÖ [MIDDLEWARE] Usuario autenticado, permitiendo acceso a:', pathname);\n    // Agregar headers de usuario para Server Actions\n    const response = NextResponse.next();\n    response.headers.set('x-user-id', userInfo.value);\n    return response;\n  }\n  \n  // Para todas las dem√°s rutas, permitir acceso\n  console.log('üîç [MIDDLEWARE] Ruta permitida:', pathname);\n  return NextResponse.next();\n}\n\n// Configurar en qu√© rutas se ejecuta el middleware\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder\n     */\n    '/((?!_next/static|_next/image|favicon.ico|public/).*)',\n  ],\n}; "],"names":[],"mappings":";;;;AAAA;AAAA;;AAIO,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,6BAA6B;IAC7B,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC;IAClC,MAAM,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC;IAErC,qBAAqB;IACrB,QAAQ,GAAG,CAAC,yBAAyB,UAAU,UAAU,CAAC,CAAC,OAAO,aAAa,CAAC,CAAC;IAEjF,gDAAgD;IAChD,MAAM,eAAe;QAAC;QAAU;QAAa;QAAoB;KAAkB;IACnF,MAAM,gBAAgB,aAAa,QAAQ,CAAC;IAE5C,iDAAiD;IACjD,MAAM,aAAa,SAAS,UAAU,CAAC;IAEvC,0EAA0E;IAC1E,MAAM,aAAa;QAAC;QAAU;KAAY;IAC1C,MAAM,cAAc,WAAW,QAAQ,CAAC;IAExC,+EAA+E;IAC/E,IAAI,eAAe,SAAS,UAAU;QACpC,QAAQ,GAAG,CAAC;QACZ,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,aAAa,QAAQ,GAAG;IAC/D;IAEA,sEAAsE;IACtE,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,OAAO;QAC3C,QAAQ,GAAG,CAAC;QACZ,MAAM,WAAW,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9C,SAAS,YAAY,CAAC,GAAG,CAAC,YAAY;QACtC,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,+DAA+D;IAC/D,IAAI,SAAS,UAAU;QACrB,QAAQ,GAAG,CAAC,6DAA6D;QACzE,iDAAiD;QACjD,MAAM,WAAW,6LAAA,CAAA,eAAY,CAAC,IAAI;QAClC,SAAS,OAAO,CAAC,GAAG,CAAC,aAAa,SAAS,KAAK;QAChD,OAAO;IACT;IAEA,8CAA8C;IAC9C,QAAQ,GAAG,CAAC,mCAAmC;IAC/C,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;AAC1B;AAGO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}