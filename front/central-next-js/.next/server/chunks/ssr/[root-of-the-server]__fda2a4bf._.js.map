{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/index.ts"],"sourcesContent":["// Exportar todas las acciones de autenticaci√≥n\nexport { loginAction } from './login.action';\nexport { logoutAction } from './logout.action';\nexport { checkAuthAction } from './check-auth.action';\nexport { getUserRolesPermissionsAction } from './get-user-roles-permissions.action';\nexport { changePasswordAction } from './change-password.action';\n\n// Exportar tipos\nexport type { LoginRequest } from './request/login';\nexport type { LoginResponse } from './response/login';\nexport type { LogoutResponse } from './logout.action';\nexport type { CheckAuthResponse } from './check-auth.action';\nexport type { GetUserRolesPermissionsResponse } from './get-user-roles-permissions.action';\nexport type { ChangePasswordRequest, ChangePasswordResponse } from './change-password.action'; "],"names":[],"mappings":"AAAA,+CAA+C","debugId":null}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/login.action.ts"],"sourcesContent":["'use server';\n\nimport { cookies } from 'next/headers';\nimport { getApiBaseUrl } from '@/server/config/env';\nimport { LoginResponse } from '@/services/auth/domain/entities/loging_response';\nimport { LoginRequest } from '@/services/auth/infrastructure/actions/request/login';\nimport { LoginCredentials } from '@/services/auth/domain/entities/Auth';\nimport { \n  mapLoginRequestToLoginCredentials,\n  mapLoginResponseToDomain\n} from '@/services/auth/infrastructure/actions/mappers';\n\nexport async function loginAction(request: LoginRequest): Promise<LoginResponse> {\n  try {\n    const loginCredentials: LoginCredentials = mapLoginRequestToLoginCredentials(request);\n    \n    const { email, password } = loginCredentials;\n\n    const response = await fetch(`${getApiBaseUrl()}/api/v1/auth/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ email, password }),\n    });\n\n    const data = await response.json();\n    \n    if (!response.ok) {\n      return data;\n    }\n    \n    const mappedResponse = mapLoginResponseToDomain(data.data);\n    \n    const cookieStore = await cookies();\n    cookieStore.set('auth-token', mappedResponse.token, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax',\n      maxAge: 60 * 60 * 24 * 7\n    });\n\n    const userWithBusinesses = {\n      ...mappedResponse.user,\n      businesses: mappedResponse.businesses\n    };\n    \n    cookieStore.set('user-info', JSON.stringify(userWithBusinesses), {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax',\n      maxAge: 60 * 60 * 24 * 7\n    });\n\n    return {\n      success: true,\n      data: mappedResponse\n    };\n  } catch (error) {\n    console.error('Login action error:', error);\n    return {\n      success: false,\n      message: 'Error interno del servidor'\n    };\n  }\n} "],"names":[],"mappings":";;;;;;IAYsB,cAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/logout.action.ts"],"sourcesContent":["'use server';\n\nimport { cookies } from 'next/headers';\n\nexport interface LogoutResponse {\n  success: boolean;\n  message?: string;\n}\n\nexport async function logoutAction(): Promise<LogoutResponse> {\n  try {\n    const cookieStore = await cookies();\n    cookieStore.delete('auth-token');\n    cookieStore.delete('user-info');\n    \n    return {\n      success: true,\n      message: 'Logout exitoso'\n    };\n  } catch (error) {\n    console.error('Logout action error:', error);\n    return {\n      success: false,\n      message: 'Error al hacer logout'\n    };\n  }\n} "],"names":[],"mappings":";;;;;;IASsB,eAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/check-auth.action.ts"],"sourcesContent":["'use server';\n\nimport { cookies } from 'next/headers';\nimport { getApiBaseUrl } from '@/server/config/env';\n\nexport interface CheckAuthResponse {\n  isAuthenticated: boolean;\n  user?: any;\n}\n\nexport async function checkAuthAction(): Promise<CheckAuthResponse> {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get('auth-token');\n    const userInfo = cookieStore.get('user-info');\n\n    if (!token || !userInfo) {\n      return { isAuthenticated: false };\n    }\n\n    // Verificar token con el backend\n    const response = await fetch(`${getApiBaseUrl()}/api/v1/auth/verify`, {\n      headers: {\n        'Authorization': `Bearer ${token.value}`,\n      },\n    });\n\n    if (!response.ok) {\n      // Token inv√°lido, limpiar cookies\n      cookieStore.delete('auth-token');\n      cookieStore.delete('user-info');\n      return { isAuthenticated: false };\n    }\n\n    const user = JSON.parse(userInfo.value);\n    return {\n      isAuthenticated: true,\n      user\n    };\n  } catch (error) {\n    console.error('Check auth action error:', error);\n    return { isAuthenticated: false };\n  }\n} "],"names":[],"mappings":";;;;;;IAUsB,kBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/get-user-roles-permissions.action.ts"],"sourcesContent":["'use server';\n\nimport { cookies } from 'next/headers';\nimport { getApiBaseUrl } from '@/server/config/env';\n\nexport interface GetUserRolesPermissionsResponse {\n  success: boolean;\n  data?: any;\n  message?: string;\n}\n\nexport async function getUserRolesPermissionsAction(): Promise<GetUserRolesPermissionsResponse> {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get('auth-token');\n\n    if (!token) {\n      return {\n        success: false,\n        message: 'No autorizado'\n      };\n    }\n\n    const response = await fetch(`${getApiBaseUrl()}/api/v1/auth/roles-permissions`, {\n      headers: {\n        'Authorization': `Bearer ${token.value}`,\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      return {\n        success: false,\n        message: errorData.message || 'Error al obtener permisos'\n      };\n    }\n\n    const data = await response.json();\n    \n    return {\n      success: true,\n      data: data.data || {}\n    };\n  } catch (error) {\n    console.error('Get user roles permissions action error:', error);\n    return {\n      success: false,\n      message: 'Error interno del servidor'\n    };\n  }\n} "],"names":[],"mappings":";;;;;;IAWsB,gCAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/change-password.action.ts"],"sourcesContent":["'use server';\n\nimport { cookies } from 'next/headers';\nimport { getApiBaseUrl } from '@/server/config/env';\n\nexport interface ChangePasswordRequest {\n  currentPassword: string;\n  newPassword: string;\n}\n\nexport interface ChangePasswordResponse {\n  success: boolean;\n  message?: string;\n}\n\nexport async function changePasswordAction(formData: FormData): Promise<ChangePasswordResponse> {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get('auth-token');\n\n    if (!token) {\n      return {\n        success: false,\n        message: 'No autorizado'\n      };\n    }\n\n    const currentPassword = formData.get('currentPassword') as string;\n    const newPassword = formData.get('newPassword') as string;\n\n    const response = await fetch(`${getApiBaseUrl()}/api/v1/auth/change-password`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${token.value}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ currentPassword, newPassword }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      return {\n        success: false,\n        message: errorData.message || 'Error al cambiar contrase√±a'\n      };\n    }\n\n    return {\n      success: true,\n      message: 'Contrase√±a cambiada exitosamente'\n    };\n  } catch (error) {\n    console.error('Change password action error:', error);\n    return {\n      success: false,\n      message: 'Error interno del servidor'\n    };\n  }\n} "],"names":[],"mappings":";;;;;;IAesB,uBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/mappers/login-response.mapper.ts"],"sourcesContent":["/**\n * Mapper para la respuesta del login\n * Convierte del backend (snake_case) al dominio (camelCase)\n * \n * RESUELVE EL PROBLEMA REAL:\n * - avatar_url ‚Üí avatarURL\n * - is_active ‚Üí isActive\n * - logo_url ‚Üí logoURL\n */\n\nimport type { LoginData } from '../response/login';\nimport type { LoginData as DomainLoginData } from '@/services/auth/domain/entities/loging_response';\n\n/**\n * Convierte la respuesta del login del backend al dominio\n */\nexport function mapLoginResponseToDomain(\n  backendResponse: LoginData\n): DomainLoginData {\n  return {\n    user: {\n      id: backendResponse.user.id,\n      name: backendResponse.user.name,\n      email: backendResponse.user.email,\n      phone: backendResponse.user.phone,\n      avatarURL: backendResponse.user.avatar_url,        // ‚Üê snake_case ‚Üí camelCase\n      isActive: backendResponse.user.is_active,          // ‚Üê snake_case ‚Üí camelCase\n      lastLoginAt: backendResponse.user.last_login_at    // ‚Üê snake_case ‚Üí camelCase\n    },\n    token: backendResponse.token,\n    requirePasswordChange: backendResponse.require_password_change,  // ‚Üê snake_case ‚Üí camelCase\n    businesses: backendResponse.businesses.map(business => ({\n      id: business.id,\n      name: business.name,\n      code: business.code,\n      businessTypeId: business.business_type_id,        // ‚Üê snake_case ‚Üí camelCase\n      businessType: {\n        id: business.business_type.id,\n        name: business.business_type.name,\n        code: business.business_type.code,\n        description: business.business_type.description,\n        icon: business.business_type.icon\n      },\n      timezone: business.timezone,\n      address: business.address,\n      description: business.description,\n      logoURL: business.logo_url,                      // ‚Üê snake_case ‚Üí camelCase\n      primaryColor: business.primary_color,            // ‚Üê snake_case ‚Üí camelCase\n      secondaryColor: business.secondary_color,        // ‚Üê snake_case ‚Üí camelCase\n      tertiaryColor: business.tertiary_color,          // ‚Üê snake_case ‚Üí camelCase\n      quaternaryColor: business.quaternary_color,      // ‚Üê snake_case ‚Üí camelCase\n      navbarImageURL: business.navbar_image_url,       // ‚Üê snake_case ‚Üí camelCase\n      customDomain: business.custom_domain,            // ‚Üê snake_case ‚Üí camelCase\n      isActive: business.is_active,                    // ‚Üê snake_case ‚Üí camelCase\n      enableDelivery: business.enable_delivery,        // ‚Üê snake_case ‚Üí camelCase\n      enablePickup: business.enable_pickup,            // ‚Üê snake_case ‚Üí camelCase\n      enableReservations: business.enable_reservations // ‚Üê snake_case ‚Üí camelCase\n    }))\n  };\n} "],"names":[],"mappings":"AAAA;;;;;;;;CAQC;;;AAQM,SAAS,yBACd,eAA0B;IAE1B,OAAO;QACL,MAAM;YACJ,IAAI,gBAAgB,IAAI,CAAC,EAAE;YAC3B,MAAM,gBAAgB,IAAI,CAAC,IAAI;YAC/B,OAAO,gBAAgB,IAAI,CAAC,KAAK;YACjC,OAAO,gBAAgB,IAAI,CAAC,KAAK;YACjC,WAAW,gBAAgB,IAAI,CAAC,UAAU;YAC1C,UAAU,gBAAgB,IAAI,CAAC,SAAS;YACxC,aAAa,gBAAgB,IAAI,CAAC,aAAa,CAAI,2BAA2B;QAChF;QACA,OAAO,gBAAgB,KAAK;QAC5B,uBAAuB,gBAAgB,uBAAuB;QAC9D,YAAY,gBAAgB,UAAU,CAAC,GAAG,CAAC,CAAA,WAAY,CAAC;gBACtD,IAAI,SAAS,EAAE;gBACf,MAAM,SAAS,IAAI;gBACnB,MAAM,SAAS,IAAI;gBACnB,gBAAgB,SAAS,gBAAgB;gBACzC,cAAc;oBACZ,IAAI,SAAS,aAAa,CAAC,EAAE;oBAC7B,MAAM,SAAS,aAAa,CAAC,IAAI;oBACjC,MAAM,SAAS,aAAa,CAAC,IAAI;oBACjC,aAAa,SAAS,aAAa,CAAC,WAAW;oBAC/C,MAAM,SAAS,aAAa,CAAC,IAAI;gBACnC;gBACA,UAAU,SAAS,QAAQ;gBAC3B,SAAS,SAAS,OAAO;gBACzB,aAAa,SAAS,WAAW;gBACjC,SAAS,SAAS,QAAQ;gBAC1B,cAAc,SAAS,aAAa;gBACpC,gBAAgB,SAAS,eAAe;gBACxC,eAAe,SAAS,cAAc;gBACtC,iBAAiB,SAAS,gBAAgB;gBAC1C,gBAAgB,SAAS,gBAAgB;gBACzC,cAAc,SAAS,aAAa;gBACpC,UAAU,SAAS,SAAS;gBAC5B,gBAAgB,SAAS,eAAe;gBACxC,cAAc,SAAS,aAAa;gBACpC,oBAAoB,SAAS,mBAAmB,CAAC,2BAA2B;YAC9E,CAAC;IACH;AACF","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/mappers/roles-permissions.mapper.ts"],"sourcesContent":["/**\n * Mapper para roles y permisos\n * Convierte del backend (snake_case) al dominio (camelCase)\n * \n * RESUELVE EL PROBLEMA REAL:\n * - resource_name ‚Üí resourceName\n * - is_super ‚Üí isSuper\n */\n\nimport type { RolesPermissionsData } from '../response/roles-permissions';\nimport type { RolesPermissionsData as DomainRolesPermissionsData } from '@/services/auth/domain/entities/roles-permissions';\n\n/**\n * Convierte la respuesta de roles y permisos del backend al dominio\n */\nexport function mapRolesPermissionsResponseToDomain(\n  backendResponse: RolesPermissionsData\n): DomainRolesPermissionsData {\n  return {\n    isSuper: backendResponse.is_super,                    // ‚Üê snake_case ‚Üí camelCase\n    roles: backendResponse.roles.map(role => ({\n      id: role.id,\n      name: role.name,\n      code: role.code,\n      description: role.description,\n      level: role.level,\n      scope: role.scope\n    })),\n    resources: backendResponse.resources.map(resource => ({\n      resource: resource.resource,\n      resourceName: resource.resource_name,               // ‚Üê snake_case ‚Üí camelCase\n      actions: resource.actions.map(action => ({\n        id: action.id,\n        name: action.name,\n        code: action.code,\n        description: action.description,\n        resource: action.resource,\n        action: action.action,\n        scope: action.scope\n      }))\n    }))\n  };\n} "],"names":[],"mappings":"AAAA;;;;;;;CAOC;;;AAQM,SAAS,oCACd,eAAqC;IAErC,OAAO;QACL,SAAS,gBAAgB,QAAQ;QACjC,OAAO,gBAAgB,KAAK,CAAC,GAAG,CAAC,CAAA,OAAQ,CAAC;gBACxC,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;gBACf,aAAa,KAAK,WAAW;gBAC7B,OAAO,KAAK,KAAK;gBACjB,OAAO,KAAK,KAAK;YACnB,CAAC;QACD,WAAW,gBAAgB,SAAS,CAAC,GAAG,CAAC,CAAA,WAAY,CAAC;gBACpD,UAAU,SAAS,QAAQ;gBAC3B,cAAc,SAAS,aAAa;gBACpC,SAAS,SAAS,OAAO,CAAC,GAAG,CAAC,CAAA,SAAU,CAAC;wBACvC,IAAI,OAAO,EAAE;wBACb,MAAM,OAAO,IAAI;wBACjB,MAAM,OAAO,IAAI;wBACjB,aAAa,OAAO,WAAW;wBAC/B,UAAU,OAAO,QAAQ;wBACzB,QAAQ,OAAO,MAAM;wBACrB,OAAO,OAAO,KAAK;oBACrB,CAAC;YACH,CAAC;IACH;AACF","debugId":null}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/mappers/auth.mapper.ts"],"sourcesContent":["/**\n * Mappers para entidades de autenticaci√≥n\n * Convierte entre diferentes formatos de datos de autenticaci√≥n\n */\n\nimport type { LoginCredentials } from '../../../domain/entities/Auth';\nimport type { LoginRequest } from '../request/login';\n\n/**\n * Convierte LoginRequest (infraestructura) a LoginCredentials (dominio)\n * @param loginRequest - Datos de login desde la infraestructura\n * @returns LoginCredentials en formato del dominio\n */\nexport function mapLoginRequestToLoginCredentials(loginRequest: LoginRequest): LoginCredentials {\n  return {\n    email: loginRequest.email,\n    password: loginRequest.password\n  };\n}\n\n/**\n * Convierte LoginCredentials (dominio) a LoginRequest (infraestructura)\n * @param loginCredentials - Credenciales del dominio\n * @returns LoginRequest en formato de infraestructura\n */\nexport function mapLoginCredentialsToLoginRequest(loginCredentials: LoginCredentials): LoginRequest {\n  return {\n    email: loginCredentials.email,\n    password: loginCredentials.password\n  };\n}\n\n/**\n * Convierte FormData a LoginCredentials (dominio)\n * @param formData - FormData del formulario de login\n * @returns LoginCredentials en formato del dominio\n */\nexport function mapFormDataToLoginCredentials(formData: FormData): LoginCredentials {\n  return {\n    email: formData.get('email') as string,\n    password: formData.get('password') as string\n  };\n}\n\n/**\n * Convierte FormData a LoginRequest (infraestructura)\n * @param formData - FormData del formulario de login\n * @returns LoginRequest en formato de infraestructura\n */\nexport function mapFormDataToLoginRequest(formData: FormData): LoginRequest {\n  return {\n    email: formData.get('email') as string,\n    password: formData.get('password') as string\n  };\n} "],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAUM,SAAS,kCAAkC,YAA0B;IAC1E,OAAO;QACL,OAAO,aAAa,KAAK;QACzB,UAAU,aAAa,QAAQ;IACjC;AACF;AAOO,SAAS,kCAAkC,gBAAkC;IAClF,OAAO;QACL,OAAO,iBAAiB,KAAK;QAC7B,UAAU,iBAAiB,QAAQ;IACrC;AACF;AAOO,SAAS,8BAA8B,QAAkB;IAC9D,OAAO;QACL,OAAO,SAAS,GAAG,CAAC;QACpB,UAAU,SAAS,GAAG,CAAC;IACzB;AACF;AAOO,SAAS,0BAA0B,QAAkB;IAC1D,OAAO;QACL,OAAO,SAAS,GAAG,CAAC;QACpB,UAAU,SAAS,GAAG,CAAC;IACzB;AACF","debugId":null}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/services/auth/infrastructure/actions/mappers/index.ts"],"sourcesContent":["/**\n * Exportaciones de todos los mappers de autenticaci√≥n\n */\n\n// Mapper para la respuesta del login (usuario, token, businesses)\nexport { mapLoginResponseToDomain } from './login-response.mapper';\n\n// Mapper para roles y permisos\nexport { mapRolesPermissionsResponseToDomain } from './roles-permissions.mapper';\n\n// Mappers para credenciales de login\nexport {\n  mapLoginRequestToLoginCredentials,\n  mapFormDataToLoginCredentials\n} from './auth.mapper';\n\n// Tipos para la respuesta del backend\nexport type { LoginData } from '../response/login';\nexport type { RolesPermissionsData } from '../response/roles-permissions';\n\n"],"names":[],"mappings":"AAAA;;CAEC,GAED,kEAAkE;;AAClE;AAEA,+BAA+B;AAC/B;AAEA,qCAAqC;AACrC","debugId":null}},
    {"offset": {"line": 244, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/shared/hooks/useDebugAuth.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef } from 'react';\n\nexport const useDebugAuth = (hookName: string) => {\n  const callCount = useRef(0);\n  const lastCall = useRef<Date>(new Date());\n\n  useEffect(() => {\n    callCount.current += 1;\n    const now = new Date();\n    const timeDiff = now.getTime() - lastCall.current.getTime();\n    \n    console.log(`üîç [${hookName}] Llamada #${callCount.current} - Tiempo desde √∫ltima: ${timeDiff}ms`);\n    \n    if (callCount.current > 5) {\n      console.warn(`‚ö†Ô∏è [${hookName}] Muchas llamadas detectadas: ${callCount.current}`);\n    }\n    \n    lastCall.current = now;\n  });\n\n  return { callCount: callCount.current };\n}; "],"names":[],"mappings":";;;AAEA;AAFA;;AAIO,MAAM,eAAe,CAAC;IAC3B,MAAM,YAAY,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAE;IACzB,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAQ,IAAI;IAElC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,UAAU,OAAO,IAAI;QACrB,MAAM,MAAM,IAAI;QAChB,MAAM,WAAW,IAAI,OAAO,KAAK,SAAS,OAAO,CAAC,OAAO;QAEzD,QAAQ,GAAG,CAAC,CAAC,IAAI,EAAE,SAAS,WAAW,EAAE,UAAU,OAAO,CAAC,wBAAwB,EAAE,SAAS,EAAE,CAAC;QAEjG,IAAI,UAAU,OAAO,GAAG,GAAG;YACzB,QAAQ,IAAI,CAAC,CAAC,IAAI,EAAE,SAAS,8BAA8B,EAAE,UAAU,OAAO,EAAE;QAClF;QAEA,SAAS,OAAO,GAAG;IACrB;IAEA,OAAO;QAAE,WAAW,UAAU,OAAO;IAAC;AACxC","debugId":null}},
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/shared/hooks/useServerAuth.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useMemo, useRef, useEffect } from 'react';\nimport { loginAction, logoutAction, checkAuthAction, getUserRolesPermissionsAction, changePasswordAction } from '@/services/auth/infrastructure/actions';\nimport { mapFormDataToLoginCredentials } from '@/services/auth/infrastructure/actions/mappers';\nimport { useDebugAuth } from './useDebugAuth';\n\nexport interface UserRolesPermissions {\n  resources: Array<{\n    id: number;\n    name: string;\n    code: string;\n    actions: Array<{\n      id: number;\n      name: string;\n      code: string;\n    }>;\n  }>;\n  permissions: Array<{\n    id: number;\n    name: string;\n    code: string;\n  }>;\n  roles: Array<{\n    id: number;\n    name: string;\n    code: string;\n    description: string;\n    level: number;\n    is_system: boolean;\n    scope_id: number;\n    scope_name: string;\n    scope_code: string;\n  }>;\n}\n\nexport interface AuthState {\n  isAuthenticated: boolean;\n  user: any | null;\n  permissions: UserRolesPermissions | null;\n  loading: boolean;\n  error: string | null;\n}\n\nexport const useServerAuth = () => {\n  // Hook de debug para monitorear llamadas\n  useDebugAuth('useServerAuth');\n\n  const [state, setState] = useState<AuthState>({\n    isAuthenticated: false,\n    user: null,\n    permissions: null,\n    loading: true,\n    error: null\n  });\n\n  // Refs para evitar m√∫ltiples llamadas simult√°neas\n  const authCheckRef = useRef<boolean>(false);\n  const permissionsCheckRef = useRef<boolean>(false);\n  const initializedRef = useRef<boolean>(false);\n\n  // Verificar autenticaci√≥n usando Server Action\n  const checkAuth = useCallback(async () => {\n    if (authCheckRef.current) {\n      console.log('üîÑ [useServerAuth] checkAuth ya se est√° ejecutando, saltando...');\n      return { isAuthenticated: state.isAuthenticated, user: state.user };\n    }\n\n    console.log('üîç [useServerAuth] Verificando autenticaci√≥n...');\n    authCheckRef.current = true;\n    \n    try {\n      setState(prev => ({ ...prev, loading: true }));\n      const result = await checkAuthAction();\n      console.log('‚úÖ [useServerAuth] Verificaci√≥n completada:', result);\n      \n      if (result.isAuthenticated) {\n        setState(prev => ({\n          ...prev,\n          isAuthenticated: true,\n          user: result.user || prev.user,\n          loading: false\n        }));\n      } else {\n        setState(prev => ({\n          ...prev,\n          isAuthenticated: false,\n          user: null,\n          loading: false\n        }));\n      }\n      \n      return result;\n    } catch (error) {\n      console.error('‚ùå [useServerAuth] Error verificando autenticaci√≥n:', error);\n      setState(prev => ({\n        ...prev,\n        isAuthenticated: false,\n        user: null,\n        loading: false\n      }));\n      return { isAuthenticated: false, user: null };\n    } finally {\n      authCheckRef.current = false;\n    }\n  }, []);\n\n  // Obtener roles y permisos usando Server Action\n  const loadUserRolesPermissions = useCallback(async () => {\n    if (permissionsCheckRef.current) {\n      console.log('üîÑ [useServerAuth] loadUserRolesPermissions ya se est√° ejecutando, saltando...');\n      return state.permissions;\n    }\n\n    console.log('üîç [useServerAuth] Iniciando loadUserRolesPermissions...');\n    console.log('üîç [useServerAuth] Estado actual:', {\n      isAuthenticated: state.isAuthenticated,\n      permissionsCheckRef: permissionsCheckRef.current,\n      loading: state.loading,\n      hasUser: !!state.user\n    });\n    \n    if (!state.isAuthenticated) {\n      console.log('üîç [useServerAuth] Usuario no autenticado, saltando carga de permisos');\n      return null;\n    }\n\n    if (!state.user) {\n      console.log('üîç [useServerAuth] No hay usuario en el estado, saltando carga de permisos');\n      return null;\n    }\n\n    permissionsCheckRef.current = true;\n    setState(prev => ({ ...prev, loading: true }));\n    \n    try {\n      console.log('üîç [useServerAuth] Llamando a getUserRolesPermissionsAction...');\n      const result = await getUserRolesPermissionsAction();\n      console.log('üîç [useServerAuth] Resultado recibido:', result);\n      \n      if (result.success && result.data) {\n        console.log('‚úÖ [useServerAuth] Permisos cargados exitosamente');\n        console.log('üìä [useServerAuth] Estructura de permisos:', {\n          hasResources: !!(result.data.resources && result.data.resources.length > 0),\n          hasPermissions: !!(result.data.permissions && result.data.permissions.length > 0),\n          hasRoles: !!(result.data.roles && result.data.roles.length > 0),\n          resourcesCount: result.data.resources?.length || 0,\n          permissionsCount: result.data.permissions?.length || 0,\n          rolesCount: result.data.roles?.length || 0\n        });\n        \n        // Agregar logging detallado de los datos recibidos\n        console.log('üîç [useServerAuth] Datos completos recibidos:', JSON.stringify(result.data, null, 2));\n        \n        setState(prev => ({\n          ...prev,\n          permissions: result.data as UserRolesPermissions,\n          loading: false,\n          error: null\n        }));\n        return result.data;\n      } else {\n        console.log('‚ùå [useServerAuth] Error al cargar permisos:', result.message);\n        setState(prev => ({\n          ...prev,\n          loading: false,\n          error: result.message || 'Error al cargar permisos'\n        }));\n        return null;\n      }\n    } catch (error) {\n      console.error('‚ùå [useServerAuth] Error en loadUserRolesPermissions:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Error interno';\n      setState(prev => ({\n        ...prev,\n        loading: false,\n        error: errorMessage\n      }));\n      return null;\n    } finally {\n      permissionsCheckRef.current = false;\n    }\n  }, [state.isAuthenticated, state.user]);\n\n  // Login usando Server Action\n  const login = useCallback(async (formData: FormData) => {\n    if (state.loading) return { success: false, message: 'Ya hay una operaci√≥n en curso' };\n    \n    console.log('üîê [useServerAuth] Login iniciado...');\n    setState(prev => ({ ...prev, loading: true, error: null }));\n    \n    try {\n      const loginRequest = mapFormDataToLoginCredentials(formData);\n      const result = await loginAction(loginRequest);\n      console.log('üîê [useServerAuth] Resultado del login:', result);\n      \n      if (result.success) {\n        setState(prev => ({\n          ...prev,\n          isAuthenticated: true,\n          user: result.data?.user,\n          loading: false,\n          error: null\n        }));\n\n        console.log('‚úÖ [useServerAuth] Login exitoso, estado actualizado');\n        console.log('üîç [useServerAuth] Esperando que las cookies est√©n disponibles...');\n        \n        // Esperar un poco m√°s para asegurar que las cookies est√©n disponibles\n        await new Promise(resolve => setTimeout(resolve, 500));\n        \n        console.log('üîç [useServerAuth] Intentando cargar permisos...');\n        \n        // Cargar permisos despu√©s del login exitoso\n        try {\n          const permissionsResult = await loadUserRolesPermissions();\n          console.log('‚úÖ [useServerAuth] Permisos cargados despu√©s del login:', permissionsResult);\n        } catch (permissionsError) {\n          console.error('‚ùå [useServerAuth] Error cargando permisos despu√©s del login:', permissionsError);\n        }\n\n        return result;\n      } else {\n        console.log('‚ùå [useServerAuth] Login fall√≥:', result.message);\n        setState(prev => ({\n          ...prev,\n          loading: false,\n          error: result.message || 'Error de autenticaci√≥n'\n        }));\n        return result;\n      }\n    } catch (error) {\n      console.error('üí• [useServerAuth] Error en login:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Error interno';\n      setState(prev => ({\n        ...prev,\n        loading: false,\n        error: errorMessage\n      }));\n      throw error;\n    }\n  }, [state.loading, loadUserRolesPermissions]);\n\n  // Logout usando Server Action\n  const logout = useCallback(async () => {\n    if (state.loading) return { success: false, message: 'Ya hay una operaci√≥n en curso' };\n    \n    setState(prev => ({ ...prev, loading: true }));\n    \n    try {\n      const result = await logoutAction();\n      \n      setState({\n        isAuthenticated: false,\n        user: null,\n        permissions: null,\n        loading: false,\n        error: null\n      });\n\n      authCheckRef.current = false;\n      permissionsCheckRef.current = false;\n      initializedRef.current = false;\n\n      return result;\n    } catch (error) {\n      setState(prev => ({ ...prev, loading: false }));\n      throw error;\n    }\n  }, [state.loading]);\n\n  // Cambiar contrase√±a usando Server Action\n  const changePassword = useCallback(async (formData: FormData) => {\n    if (state.loading) return { success: false, message: 'Ya hay una operaci√≥n en curso' };\n    \n    setState(prev => ({ ...prev, loading: true, error: null }));\n    \n    try {\n      const result = await changePasswordAction(formData);\n      \n      setState(prev => ({ ...prev, loading: false }));\n      \n      if (!result.success) {\n        setState(prev => ({ ...prev, error: result.message || 'Error al cambiar contrase√±a' }));\n      }\n      \n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Error interno';\n      setState(prev => ({\n        ...prev,\n        loading: false,\n        error: errorMessage\n      }));\n      throw error;\n    }\n  }, [state.loading]);\n\n  // Limpiar error\n  const clearError = useCallback(() => {\n    setState(prev => ({ ...prev, error: null }));\n  }, []);\n\n  // Forzar recarga de permisos (√∫til para debugging)\n  const forceReloadPermissions = useCallback(async () => {\n    console.log('üîÑ [useServerAuth] Forzando recarga de permisos...');\n    permissionsCheckRef.current = false;\n    initializedRef.current = false;\n    \n    try {\n      const result = await loadUserRolesPermissions();\n      console.log('‚úÖ [useServerAuth] Permisos recargados forzadamente:', result);\n      return result;\n    } catch (error) {\n      console.error('‚ùå [useServerAuth] Error en recarga forzada de permisos:', error);\n      return null;\n    }\n  }, [loadUserRolesPermissions]);\n\n  // Verificar si tiene un permiso espec√≠fico\n  const hasPermission = useCallback((permissionCode: string): boolean => {\n    if (!state.permissions) return false;\n    \n    if (state.permissions.resources) {\n      for (const resource of state.permissions.resources) {\n        if (resource.actions && Array.isArray(resource.actions)) {\n          const hasAction = resource.actions.some((action: any) => action.code === permissionCode);\n          if (hasAction) return true;\n        }\n      }\n    }\n    \n    if (state.permissions.permissions) {\n      return state.permissions.permissions.some((permission: any) => permission.code === permissionCode);\n    }\n    \n    return false;\n  }, [state.permissions]);\n\n  // Verificar si tiene un rol espec√≠fico\n  const hasRole = useCallback((roleName: string): boolean => {\n    if (!state.permissions || !state.permissions.roles) return false;\n    return state.permissions.roles.some((role: any) => role.name === roleName);\n  }, [state.permissions]);\n\n  // Verificar si es super admin\n  const isSuperAdmin = useCallback((): boolean => {\n    return hasRole('super_admin') || hasRole('admin');\n  }, [hasRole]);\n\n  // Inicializar autenticaci√≥n\n  const initializeAuth = useCallback(async () => {\n    if (initializedRef.current) {\n      console.log('üîÑ [useServerAuth] Ya inicializado, saltando...');\n      return;\n    }\n\n    console.log('üöÄ [useServerAuth] Iniciando initializeAuth...');\n    initializedRef.current = true;\n    \n    try {\n      console.log('üîç [useServerAuth] Llamando a checkAuth...');\n      const authResult = await checkAuth();\n      console.log('‚úÖ [useServerAuth] checkAuth completado:', authResult);\n      \n      if (authResult.isAuthenticated && authResult.user) {\n        console.log('üîç [useServerAuth] Usuario autenticado, cargando permisos...');\n        console.log('üë§ [useServerAuth] Usuario completo:', authResult.user.email);\n        console.log('üè¢ [useServerAuth] Informaci√≥n del negocio disponible:', {\n          hasBusinesses: !!(authResult.user.businesses && authResult.user.businesses.length > 0),\n          businessCount: authResult.user.businesses?.length || 0,\n          hasPrimaryColor: !!authResult.user.businesses?.[0]?.primary_color,\n          hasNavbarImage: !!authResult.user.businesses?.[0]?.navbar_image_url\n        });\n        \n        try {\n          // Cargar permisos despu√©s de verificar autenticaci√≥n\n          const permissionsResult = await loadUserRolesPermissions();\n          console.log('‚úÖ [useServerAuth] Permisos cargados en initializeAuth:', permissionsResult);\n        } catch (error) {\n          console.error('‚ùå [useServerAuth] Error cargando permisos en initializeAuth:', error);\n        }\n      } else {\n        console.log('üîç [useServerAuth] Usuario no autenticado o sin datos, saltando carga de permisos');\n      }\n    } catch (error) {\n      console.error('‚ùå [useServerAuth] Error en initializeAuth:', error);\n    }\n  }, [checkAuth, loadUserRolesPermissions]);\n\n  // Memoizar valores derivados\n  const memoizedState = useMemo(() => ({\n    ...state,\n    hasPermission,\n    hasRole,\n    isSuperAdmin\n  }), [state, hasPermission, hasRole, isSuperAdmin]);\n\n  // Ejecutar initializeAuth solo una vez al montar\n  useEffect(() => {\n    console.log('üöÄ [useServerAuth] Hook montado, ejecutando initializeAuth...');\n    initializeAuth();\n  }, []); // Remover dependencias para evitar recreaci√≥n\n\n  // Cargar permisos autom√°ticamente cuando el usuario cambie\n  useEffect(() => {\n    console.log('üîÑ [useServerAuth] useEffect - Usuario cambi√≥:', {\n      isAuthenticated: state.isAuthenticated,\n      hasUser: !!state.user,\n      hasPermissions: !!state.permissions,\n      permissionsCount: state.permissions ? 'presente' : 'ausente'\n    });\n    \n    if (state.isAuthenticated && state.user && !state.permissions) {\n      console.log('üîÑ [useServerAuth] Usuario autenticado sin permisos, cargando...');\n      loadUserRolesPermissions();\n    }\n  }, [state.isAuthenticated, state.user, state.permissions]);\n\n  return {\n    ...memoizedState,\n    login,\n    logout,\n    checkAuth,\n    loadUserRolesPermissions,\n    changePassword,\n    clearError,\n    initializeAuth,\n    hasPermission,\n    hasRole,\n    isSuperAdmin,\n    forceReloadPermissions\n  };\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 701, "column": 0}, "map": {"version":3,"sources":["file:///home/cam/Desktop/reserve/front/central-next-js/src/shared/contexts/AppContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { User } from '@/services/users/domain/entities/User';\nimport { useServerAuth } from '@/shared/hooks/useServerAuth';\n\ninterface AppContextType {\n  // Estado global esencial\n  user: User | null;\n  permissions: string[];\n  \n  // Estado de carga\n  isLoading: boolean;\n  isInitialized: boolean;\n  \n  // Funciones\n  initializeApp: () => Promise<void>;\n  updateUser: (userData: Partial<User>) => void;\n  clearApp: () => void;\n  \n  // Utilidades\n  hasPermission: (permission: string) => boolean;\n  isSuperAdmin: () => boolean;\n}\n\nconst AppContext = createContext<AppContextType | undefined>(undefined);\n\ninterface AppProviderProps {\n  children: React.ReactNode;\n}\n\nexport const AppProvider: React.FC<AppProviderProps> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [permissions, setPermissions] = useState<string[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isInitialized, setIsInitialized] = useState(false);\n  \n  // Flag para evitar m√∫ltiples inicializaciones\n  const initializationRef = useRef(false);\n\n  // Usar el nuevo hook de Server Actions\n  const {\n    isAuthenticated,\n    user: authUser,\n    permissions: authPermissions,\n    loading: authLoading,\n    error: authError,\n    initializeAuth,\n    hasPermission: serverHasPermission,\n    isSuperAdmin: serverIsSuperAdmin\n  } = useServerAuth();\n\n  // Funci√≥n para aplicar tema del negocio\n  const applyBusinessTheme = useCallback((user: User | null) => {\n    if (!user || !user.businesses || user.businesses.length === 0) return;\n    \n    const business = user.businesses[0] as any; // Usar any temporalmente para evitar errores de tipo\n    if (typeof document !== 'undefined') {\n      const root = document.documentElement;\n      if (business.primary_color) {\n        root.style.setProperty('--primary-color', business.primary_color);\n      }\n      if (business.secondary_color) {\n        root.style.setProperty('--secondary-color', business.secondary_color);\n      }\n      if (business.tertiary_color) {\n        root.style.setProperty('--tertiary-color', business.tertiary_color);\n      }\n      if (business.quaternary_color) {\n        root.style.setProperty('--quaternary-color', business.quaternary_color);\n      }\n      if (business.navbar_image_url) {\n        root.style.setProperty('--navbar-image', `url(${business.navbar_image_url})`);\n      }\n    }\n  }, []);\n\n  // Asegurar que el tema quede aplicado incluso si otros efectos lo pisan\n  const ensureThemeApplied = useCallback((user: User | null) => {\n    if (typeof document === 'undefined') return;\n    if (!user || !user.businesses || user.businesses.length === 0) return;\n    const business = user.businesses[0] as any; // Usar any temporalmente para evitar errores de tipo\n    const root = document.documentElement;\n    const currentPrimary = getComputedStyle(root).getPropertyValue('--primary-color').trim();\n    const currentSecondary = getComputedStyle(root).getPropertyValue('--secondary-color').trim();\n    const currentTertiary = getComputedStyle(root).getPropertyValue('--tertiary-color').trim();\n    const currentQuaternary = getComputedStyle(root).getPropertyValue('--quaternary-color').trim();\n    const currentNavbarImage = getComputedStyle(root).getPropertyValue('--navbar-image').trim();\n    const targetPrimary = business.primary_color || '';\n    const targetSecondary = business.secondary_color || '';\n    const targetTertiary = business.tertiary_color || '';\n    const targetQuaternary = business.quaternary_color || '';\n    const targetNavbarImage = business.navbar_image_url ? `url(${business.navbar_image_url})` : '';\n    // Si no coincide con el negocio, reestablecer\n    if (targetPrimary && currentPrimary !== targetPrimary) {\n      root.style.setProperty('--primary-color', targetPrimary);\n    }\n    if (targetSecondary && currentSecondary !== targetSecondary) {\n      root.style.setProperty('--secondary-color', targetSecondary);\n    }\n    if (targetTertiary && currentTertiary !== targetTertiary) {\n      root.style.setProperty('--tertiary-color', targetTertiary);\n    }\n    if (targetQuaternary && currentQuaternary !== targetQuaternary) {\n      root.style.setProperty('--quaternary-color', targetQuaternary);\n    }\n    if (targetNavbarImage && currentNavbarImage !== targetNavbarImage) {\n      root.style.setProperty('--navbar-image', targetNavbarImage);\n    }\n  }, []);\n\n  // Funci√≥n para inicializar la aplicaci√≥n (se ejecuta UNA SOLA VEZ)\n  const initializeApp = useCallback(async () => {\n    if (initializationRef.current) {\n      console.log('üîÑ AppContext: Ya est√° inicializado, saltando...');\n      return;\n    }\n\n    // Protecci√≥n adicional contra re-inicializaci√≥n\n    if (isLoading) {\n      console.log('üîÑ AppContext: Ya est√° cargando, saltando...');\n      return;\n    }\n\n    console.log('üöÄ AppContext: Inicializando aplicaci√≥n...');\n    console.log('üîç AppContext: Estado actual:', {\n      isAuthenticated,\n      authUser: !!authUser,\n      authPermissions: !!authPermissions,\n      authLoading,\n      authError\n    });\n    \n    setIsLoading(true);\n\n    try {\n      // 1. Inicializar autenticaci√≥n usando Server Actions\n      console.log('üîç AppContext: Llamando a initializeAuth...');\n      await initializeAuth();\n      console.log('‚úÖ AppContext: initializeAuth completado');\n      \n      // 2. Usar informaci√≥n del usuario del hook de autenticaci√≥n\n      if (authUser) {\n        console.log('‚úÖ AppContext: Usuario autenticado encontrado');\n        setUser(authUser);\n        applyBusinessTheme(authUser);\n      }\n\n      // 3. Procesar permisos del hook de autenticaci√≥n\n      if (authPermissions) {\n        console.log('üîç AppContext: Procesando permisos...');\n        let userPermissions: string[] = [];\n\n        // Procesar la estructura correcta del backend: resources.actions\n        if (authPermissions.resources && Array.isArray(authPermissions.resources)) {\n          authPermissions.resources.forEach((resource: any) => {\n            if (resource.actions && Array.isArray(resource.actions)) {\n              resource.actions.forEach((action: any) => {\n                if (action.code) {\n                  userPermissions.push(action.code);\n                }\n              });\n            }\n          });\n        }\n\n        // Tambi√©n agregar permisos directos si existen\n        if (authPermissions.permissions && Array.isArray(authPermissions.permissions)) {\n          authPermissions.permissions.forEach((permission: any) => {\n            if (permission.code) {\n              userPermissions.push(permission.code);\n            }\n          });\n        }\n\n        setPermissions(userPermissions);\n        console.log('‚úÖ AppContext: Permisos cargados desde Server Actions:', userPermissions);\n      }\n\n      setIsInitialized(true);\n      initializationRef.current = true; // Marcar como inicializado\n      console.log('‚úÖ AppContext: Aplicaci√≥n inicializada correctamente');\n\n    } catch (error) {\n      console.error('‚ùå AppContext: Error durante la inicializaci√≥n:', error);\n      if (authError) {\n        console.error('‚ùå AppContext: Error de autenticaci√≥n:', authError);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, [isLoading, initializeAuth, applyBusinessTheme, isAuthenticated, authUser, authPermissions, authLoading, authError]);\n\n  // Inicializar aplicaci√≥n cuando el hook de autenticaci√≥n est√© listo\n  useEffect(() => {\n    // Solo inicializar UNA SOLA VEZ cuando no est√© inicializado\n    if (!initializationRef.current && !authLoading && !authError) {\n      console.log('üîç AppContext: Condiciones cumplidas, iniciando...');\n      initializeApp();\n    } else {\n      console.log('üîç AppContext: Saltando inicializaci√≥n:', {\n        isInitialized: initializationRef.current,\n        authLoading,\n        authError: !!authError\n      });\n    }\n  }, [initializationRef.current, authLoading, authError, initializeApp]);\n\n  // Sincronizar loading del hook de autenticaci√≥n (SIMPLIFICADO)\n  useEffect(() => {\n    if (authLoading && !isLoading) {\n      setIsLoading(true);\n    } else if (!authLoading && isLoading && !initializationRef.current) {\n      setIsLoading(false);\n    }\n  }, [authLoading, isLoading, initializationRef.current]);\n\n  // Sincronizar estado del hook de autenticaci√≥n (UNA SOLA VEZ)\n  useEffect(() => {\n    console.log('üîÑ [AppContext] useEffect - Sincronizando usuario:', {\n      authUser: !!authUser,\n      user: !!user,\n      shouldUpdate: authUser && !user\n    });\n    \n    if (authUser && !user) {\n      console.log('‚úÖ [AppContext] Actualizando usuario del contexto');\n      setUser(authUser);\n      applyBusinessTheme(authUser);\n    }\n  }, [authUser, user, applyBusinessTheme]);\n\n  // Sincronizar permisos del hook de autenticaci√≥n (UNA SOLA VEZ)\n  useEffect(() => {\n    console.log('üîÑ [AppContext] useEffect - Sincronizando permisos:', {\n      authPermissions: !!authPermissions,\n      permissions: permissions.length,\n      shouldUpdate: authPermissions && permissions.length === 0\n    });\n    \n    if (authPermissions) {\n      console.log('‚úÖ [AppContext] Actualizando permisos del contexto');\n      console.log('üìä [AppContext] Estructura de authPermissions:', {\n        hasResources: !!(authPermissions.resources && authPermissions.resources.length > 0),\n        hasPermissions: !!(authPermissions.permissions && authPermissions.permissions.length > 0),\n        hasRoles: !!(authPermissions.roles && authPermissions.roles.length > 0),\n        resourcesCount: authPermissions.resources?.length || 0,\n        permissionsCount: authPermissions.permissions?.length || 0,\n        rolesCount: authPermissions.roles?.length || 0\n      });\n      \n      // Agregar logging detallado de authPermissions\n      console.log('üîç [AppContext] authPermissions completo:', JSON.stringify(authPermissions, null, 2));\n      \n      let userPermissions: string[] = [];\n\n      // Procesar la estructura correcta del backend: resources.actions\n      if (authPermissions.resources && Array.isArray(authPermissions.resources)) {\n        console.log('üîç [AppContext] Procesando resources.actions...');\n        authPermissions.resources.forEach((resource: any) => {\n          if (resource.actions && Array.isArray(resource.actions)) {\n            resource.actions.forEach((action: any) => {\n              if (action.code) {\n                userPermissions.push(action.code);\n                console.log('‚úÖ [AppContext] Permiso agregado:', action.code);\n              }\n            });\n          }\n        });\n      }\n\n      // Tambi√©n agregar permisos directos si existen\n      if (authPermissions.permissions && Array.isArray(authPermissions.permissions)) {\n        console.log('üîç [AppContext] Procesando permissions directos...');\n        authPermissions.permissions.forEach((permission: any) => {\n          if (permission.code) {\n            userPermissions.push(permission.code);\n            console.log('‚úÖ [AppContext] Permiso directo agregado:', permission.code);\n          }\n        });\n      }\n\n      setPermissions(userPermissions);\n      console.log('‚úÖ [AppContext] Permisos sincronizados desde Server Actions:', userPermissions);\n    } else {\n      console.log('‚ùå [AppContext] No hay authPermissions disponibles');\n    }\n  }, [authPermissions]);\n\n  // Funci√≥n para actualizar usuario\n  const updateUser = useCallback((userData: Partial<User>) => {\n    setUser(prev => {\n      if (!prev) return prev;\n      const updatedUser = { ...prev, ...userData };\n      applyBusinessTheme(updatedUser);\n      return updatedUser;\n    });\n  }, [applyBusinessTheme]);\n\n  // Funci√≥n para limpiar aplicaci√≥n\n  const clearApp = useCallback(() => {\n    setUser(null);\n    setPermissions([]);\n    setIsInitialized(false);\n    setIsLoading(false);\n    initializationRef.current = false; // Resetear el flag\n  }, []);\n\n  // Funci√≥n para verificar permisos (usar Server Actions)\n  const hasPermission = useCallback((permission: string): boolean => {\n    return serverHasPermission(permission);\n  }, [serverHasPermission]);\n\n  // Funci√≥n para verificar si es super admin (usar Server Actions)\n  const isSuperAdmin = useCallback((): boolean => {\n    return serverIsSuperAdmin();\n  }, [serverIsSuperAdmin]);\n\n  // Memoizar contexto para evitar re-renderizados innecesarios\n  const contextValue = useMemo(() => ({\n    user,\n    permissions,\n    isLoading,\n    isInitialized,\n    initializeApp,\n    updateUser,\n    clearApp,\n    hasPermission,\n    isSuperAdmin\n  }), [\n    user,\n    permissions,\n    isLoading,\n    isInitialized,\n    initializeApp,\n    updateUser,\n    clearApp,\n    hasPermission,\n    isSuperAdmin\n  ]);\n\n  return (\n    <AppContext.Provider value={contextValue}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\n// Hook personalizado para usar el contexto\nexport const useAppContext = () => {\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useAppContext debe ser usado dentro de AppProvider');\n  }\n  return context;\n};\n\nexport default AppContext; "],"names":[],"mappings":"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","debugId":null}}]
}